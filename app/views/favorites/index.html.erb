<h2 class="mb-4 text-center">ãŠæ°—ã«å…¥ã‚Šä¸€è¦§</h2>

<% @grouped.each do |textbook, chapters| %>

  <!-- æ•™ç§‘æ›¸ãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <div class="d-flex align-items-center mb-3 p-2 border rounded shadow-sm"
       style="background:#f9f9f9;">
    <% if textbook.cover_image.present? %>
      <%= image_tag textbook.cover_image,
                    style: "width:70px; height:100px; object-fit:cover; border-radius:4px;",
                    alt: textbook.name %>
    <% else %>
      <div style="width:70px; height:100px; background:#ccc; border-radius:4px;"></div>
    <% end %>

    <div class="ms-3">
      <h4 class="mb-1"><%= textbook.name %></h4>
      <small class="text-muted"><%= textbook.level %> / <%= textbook.series %></small>
    </div>
  </div>

  <!-- ç« ã”ã¨ã®ãƒªã‚¹ãƒˆ -->
  <% chapters.each do |chapter, audios| %>

    <% audios.each do |audio| %>
      <div class="d-flex justify-content-between align-items-center p-2 mb-2 border rounded">
        
        <!-- ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆchapter.titleã§OKï¼‰ -->
        <%= link_to chapter.title,
                    textbook_chapter_audio_path(textbook, chapter, audio),
                    style: "text-decoration:none; color:inherit;" %>

        <!-- ãŠæ°—ã«å…¥ã‚Šãƒœã‚¿ãƒ³ -->
        <%= render "audios/favorite_button", audio: audio %>
      </div>
    <% end %>
  <% end %>

  <hr class="my-4">

<% end %>
<%= render "shared/navigation_tab" %>

<style>
/* ===== å…¨ä½“ ===== */
.favorite-list {
  max-width: 720px;
  margin: 0 auto;
  padding-bottom: 120px; /* ä¸‹ãƒŠãƒ“å¯¾ç­– */
}

/* ===== æ•™ç§‘æ›¸ã‚«ãƒ¼ãƒ‰ ===== */
.textbook-card {
  background: #fafafa;
}

/* è¡¨ç´™ */
.textbook-cover {
  width: 72px;
  height: 100px;
  object-fit: cover;
  border-radius: 6px;
  flex-shrink: 0;
}

.textbook-cover.placeholder {
  background: #d1d5db;
}

/* ===== ç« ãƒªã‚¹ãƒˆ ===== */
.chapter-list {
  border-top: 1px dashed #e5e7eb;
  padding-top: 8px;
}

/* å„ç«  */
.chapter-item {
  padding: 10px 6px;
  border-bottom: 1px solid #f1f5f9;
}

.chapter-item:last-child {
  border-bottom: none;
}

/* ã‚¿ã‚¤ãƒˆãƒ« */
.chapter-title {
  font-size: 0.9rem;
  color: #111827;
  text-decoration: none;
  flex-grow: 1;
  margin-right: 8px;
}

.chapter-title:hover {
  text-decoration: underline;
}

/* ğŸ“± ã‚¹ãƒãƒ›èª¿æ•´ */
@media (max-width: 640px) {
  .chapter-title {
    font-size: 0.85rem;
  }
}
</style>
