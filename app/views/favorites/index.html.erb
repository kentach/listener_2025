<div class="container my-5">
  <h2 class="mb-4 text-center fw-bold">ãŠæ°—ã«å…¥ã‚Šä¸€è¦§</h2>

  <% @grouped.each do |textbook, chapters| %>

    <!-- æ•™ç§‘æ›¸ã‚«ãƒ¼ãƒ‰ -->
    <div class="card mb-4 shadow-sm border-0">

      <!-- æ•™ç§‘æ›¸ãƒ˜ãƒƒãƒ€ãƒ¼ -->
      <div class="card-body d-flex align-items-center gap-3">
        <% if textbook.cover_image.present? %>
          <%= image_tag textbook.cover_image,
                class: "rounded",
                style: "width:70px; height:100px; object-fit:cover;",
                alt: textbook.name %>
        <% else %>
          <div class="rounded bg-secondary-subtle"
               style="width:70px; height:100px;"></div>
        <% end %>

        <div>
          <h5 class="mb-1 fw-bold"><%= textbook.name %></h5>
          <small class="text-muted">
            <%= textbook.level %> / <%= textbook.series %>
          </small>
        </div>
      </div>

      <!-- ãŠæ°—ã«å…¥ã‚ŠéŸ³å£°ãƒªã‚¹ãƒˆ -->
      <div class="list-group list-group-flush">
        <% chapters.each do |chapter, audios| %>
          <% audios.each do |audio| %>
            <div class="list-group-item d-flex justify-content-between align-items-center py-3">
              <%= link_to chapter.title,
                    textbook_chapter_audio_path(textbook, chapter, audio),
                    class: "fw-medium text-decoration-none text-dark" %>

              <%= render "audios/favorite_button", audio: audio %>
            </div>
          <% end %>
        <% end %>
      </div>

    </div>
  <% end %>
</div>

<%= render "shared/navigation_tab" %>

<style>
/* ===== å…¨ä½“ ===== */
.favorite-list {
  max-width: 720px;
  margin: 0 auto;
  padding-bottom: 120px; /* ä¸‹ãƒŠãƒ“å¯¾ç­– */
}

/* ===== æ•™ç§‘æ›¸ã‚«ãƒ¼ãƒ‰ ===== */
.textbook-card {
  background: #fafafa;
}

/* è¡¨ç´™ */
.textbook-cover {
  width: 72px;
  height: 100px;
  object-fit: cover;
  border-radius: 6px;
  flex-shrink: 0;
}

.textbook-cover.placeholder {
  background: #d1d5db;
}

/* ===== ç« ãƒªã‚¹ãƒˆ ===== */
.chapter-list {
  border-top: 1px dashed #e5e7eb;
  padding-top: 8px;
}

/* å„ç«  */
.chapter-item {
  padding: 10px 6px;
  border-bottom: 1px solid #f1f5f9;
}

.chapter-item:last-child {
  border-bottom: none;
}

/* ã‚¿ã‚¤ãƒˆãƒ« */
.chapter-title {
  font-size: 0.9rem;
  color: #111827;
  text-decoration: none;
  flex-grow: 1;
  margin-right: 8px;
}

.chapter-title:hover {
  text-decoration: underline;
}

/* ğŸ“± ã‚¹ãƒãƒ›èª¿æ•´ */
@media (max-width: 640px) {
  .chapter-title {
    font-size: 0.85rem;
  }
}

.list-group-item:hover {
  background: #f8fafc;
}

.card {
  border-radius: 12px;
}
</style>
