<%# ãƒ“ãƒ¥ãƒ¼æœ€ä¸Šéƒ¨ %>
<% levels = ["è‹±æ¤œ5ç´š", "è‹±æ¤œ4ç´š", "è‹±æ¤œ3ç´š", "è‹±æ¤œæº–2ç´š", "è‹±æ¤œæº–2ç´šãƒ—ãƒ©ã‚¹", "è‹±æ¤œ2ç´š", "è‹±æ¤œæº–1ç´š", "è‹±æ¤œ1ç´š"] %>
<% current_index = levels.index(current_user.eiken_level) || 0 %>

<div class="eiken-container-vertical">
  <div class="eiken-card-vertical">

    <p class="eiken-title">ğŸ“ ã‚ãªãŸã®è‹±æ¤œç´š</p>

    <div class="levels-vertical-wrapper">

      <!-- æ£’ã‚°ãƒ©ãƒ• -->
      <div class="level-bar">
        <div class="level-bar-fill"></div>
        <div class="level-arrow">â–²</div>
      </div>

      <div class="levels-vertical">
        <% levels.each_with_index do |level, index| %>
          <% color = if index <= current_index
            case level
            when "è‹±æ¤œ1ç´š" then "#8b5cf6"
            when "è‹±æ¤œæº–1ç´š" then "#6366f1"
            when "è‹±æ¤œ2ç´š" then "#3b82f6"
            when "è‹±æ¤œæº–2ç´šãƒ—ãƒ©ã‚¹" then "#60a5fa"
            when "è‹±æ¤œæº–2ç´š" then "#38bdf8"
            when "è‹±æ¤œ3ç´š" then "#10b981"
            when "è‹±æ¤œ4ç´š" then "#047857"
            when "è‹±æ¤œ5ç´š" then "#a3e635"
            end
          else
            "#d1d5db"
          end %>
          <div class="level-item <%= 'active' if index == current_index %>"
               style="background-color: <%= color %>">
            <span class="level-name"><%= level %></span>
          </div>
        <% end %>
      </div>

    </div>

    <div class="eiken-edit">
      <%= link_to "è‹±æ¤œç´šã‚’å¤‰æ›´ã™ã‚‹",
          edit_profile_user_path(anchor: "eiken"),
          class: "edit-btn" %>
    </div>

  </div>
</div>
<%= render "shared/navigation_tab" %>

<style>
.eiken-container-vertical {
  display: flex;
  justify-content: center;
  padding: 24px 16px;
}

.eiken-card-vertical {
  width: 100%;
  max-width: 360px;
  padding: 20px;
  background: #f9fafb;
  border-radius: 18px;
  border: 1px dashed #d1d5db;
  text-align: center;
}

/* ã‚¿ã‚¤ãƒˆãƒ« */
.eiken-title {
  font-weight: 700;
  margin-bottom: 18px;
}

/* ç¸¦éšæ®µ */
.levels-vertical-wrapper {
  display: flex;
  justify-content: center;
  position: relative;
  gap: 12px;
}

.levels-vertical {
  display: flex;
  flex-direction: column-reverse;
  gap: 12px;
}

/* å„ç´š */
.level-item {
  padding: 14px 12px;
  border-radius: 12px;
  color: #fff;
  font-weight: 600;
  text-align: center;
  transition: transform 0.3s, box-shadow 0.3s;
}

.level-item.active {
  transform: scale(1.1);
  box-shadow: 0 6px 16px rgba(0,0,0,0.3);
  border: 2px solid #fff;
}

/* æ£’ã‚°ãƒ©ãƒ• */
.level-bar {
  width: 12px;
  background: #d1d5db; /* æœªå–å¾—éƒ¨åˆ†ã¯ã‚°ãƒ¬ãƒ¼ */
  border-radius: 6px;
  margin-right: 16px;
  display: flex;
  flex-direction: column-reverse;
  position: relative;
  overflow: hidden;
}

/* æ£’ã®å¡—ã‚Š (ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚«ãƒ©ãƒ¼) */
.level-bar-fill {
  width: 100%;
  background: linear-gradient(to top,
    #a3e635,
    #047857,
    #10b981,
    #38bdf8,
    #60a5fa,
    #3b82f6,
    #6366f1,
    #8b5cf6
  );
  height: 0;
  border-radius: 6px 6px 0 0;
  animation: fillBar 1s forwards;
}

/* çŸ¢å° */
.level-arrow {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  font-size: 16px;
  color: #8b5cf6;
  bottom: 0;
  transition: bottom 1s ease;
}

/* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
@keyframes fillBar {
  0% { height: 0; }
  100% {
    height: calc((<%= current_index + 1 %> / 8) * 100%);
  }
}

/* çŸ¢å°ã®ä½ç½® */
.level-arrow {
  bottom: calc((<%= current_index + 1 %> / 8) * 100% - 8px);
}

/* ç·¨é›†ãƒœã‚¿ãƒ³ */
.eiken-edit {
  margin-top: 20px;
}

.edit-btn {
  display: block;
  width: 100%;
  max-width: 320px;
  margin: 0 auto;
  padding: 14px;
  border-radius: 999px;
  background: #fff7ed;
  color: #f97316;
  font-weight: 700;
  border: 2px solid #fdba74;
  text-decoration: none;
}

.edit-btn:hover {
  background: #f97316;
  color: #fff;
}
</style>
