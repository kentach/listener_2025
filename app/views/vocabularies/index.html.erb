<section class="level-slider-section">
  <h2 class="section-title">英検級を選択</h2>

  <div class="level-slider-wrapper">
    <div class="level-slider" id="level-slider">
      <% ["準1級", "2級", "準2級", "準2級プラス", "3級", "4級", "5級"].each do |level| %>
        <div class="level-card">
          <%= link_to level, level_vocabularies_path(level: level), class: "level-link" %>
        </div>
      <% end %>
    </div>
  </div>
</section>

<%= render "shared/navigation_tab" %>

<style>
.level-slider-section {
  padding: 40px 10px;
  text-align: center;
}

.section-title {
  font-size: 24px;
  font-weight: 700;
  margin-bottom: 24px;
}

/* スライダー外枠 */
.level-slider-wrapper {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch; /* スマホで慣性スクロール */
  padding-bottom: 10px;
}

/* スライダーコンテナ */
.level-slider {
  display: flex;
  gap: 12px;
  justify-content: flex-start; /* 左寄せにして自然にスクロール */
  scroll-snap-type: x mandatory;  /* スマホでスナップ効果 */
}

/* カード本体 */
.level-card {
  flex: 0 0 auto; /* 幅固定、スクロール可能 */
  min-width: 120px;
  max-width: 140px;
  height: 140px;
  background: #ffffff;
  border-radius: 16px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.1);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 18px;
  cursor: pointer;
  scroll-snap-align: start; /* スナップ開始位置 */
  transition: transform 0.2s;
}

.level-card:hover {
  transform: translateY(-4px);
}

.level-link {
  display: block;
  width: 100%;
  height: 100%;
  line-height: 140px;
  text-decoration: none;
  color: #333;
  text-align: center;
}

/* レスポンシブ微調整 */
@media (max-width: 480px) {
  .level-card {
    min-width: 100px;
    max-width: 120px;
    height: 120px;
    font-size: 16px;
    line-height: 120px;
  }

  .section-title {
    font-size: 20px;
  }
}
</style>
<script>
  // スライダーのドラッグ操作を有効にする
  const slider = document.getElementById('level-slider');
  let isDown = false;
  let startX;
  let scrollLeft;

  const slider = document.getElementById('level-slider');
let isDown = false;
let startX;
let scrollLeft;

// PC用マウス操作
slider.addEventListener('mousedown', (e) => {
  isDown = true;
  slider.classList.add('active');
  startX = e.pageX - slider.offsetLeft;
  scrollLeft = slider.scrollLeft;
});
slider.addEventListener('mouseleave', () => {
  isDown = false;
  slider.classList.remove('active');
});
slider.addEventListener('mouseup', () => {
  isDown = false;
  slider.classList.remove('active');
});
slider.addEventListener('mousemove', (e) => {
  if(!isDown) return;
  e.preventDefault();
  const x = e.pageX - slider.offsetLeft;
  const walk = (x - startX) * 2;
  slider.scrollLeft = scrollLeft - walk;
});

// スマホ用タッチ操作
slider.addEventListener('touchstart', (e) => {
  isDown = true;
  startX = e.touches[0].pageX - slider.offsetLeft;
  scrollLeft = slider.scrollLeft;
});

slider.addEventListener('touchend', () => {
  isDown = false;
});

slider.addEventListener('touchmove', (e) => {
  if(!isDown) return;
  const x = e.touches[0].pageX - slider.offsetLeft;
  const walk = (x - startX) * 2;
  slider.scrollLeft = scrollLeft - walk;
});

</script>